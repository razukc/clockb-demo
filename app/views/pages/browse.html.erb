<%= content_for :page_title, 'Browse our events' %>


<div class="row">
  <div class="large-3 medium-3 columns width-finder bg-left hide-for-small-only" data-equalizer-watch>
    <ul class="side-nav">
      <li class="heading" style="color:#e3e3e3;">Browse our Events</li>
      <li class="divider"></li>
    </ul>
  </div>
	<div class="large-9 medium-9 columns bg-right" style="padding-top:25px;" data-equalizer-watch>
  <div id="myModal-content" class="reveal-modal small" data-reveal></div>
  <%if @events_all.blank? %>
  <%= image_tag "http://res.cloudinary.com/hn61epjje/image/upload/v1457032673/Browse_kjiqn7.png", class: 'th-no-hover' %>
  <hr>
  <% end %>
        <ul class="no-bullet">
          <% if !@events_single.nil? %>
            <% if @events_single.form_params['type'] == 'main' %>
            <%= render partial: "pages/main_event" %>
            <% end %>
            <li><h4><%= @events_single.form_params['name'] %></h4></li>
            <% if @events_single.form_params['type'] == 'weekly' %>
              <% if !@events_single.attachment.blank? %>
              <p><%= image_tag @events_single.attachment_url, class: 'th-no-hover lazyload' %></p>
              <% end %>
            <% end -%>
            <% if @events_single.form_params['type'] == 'main' %>
              <div class="clearfix">
                <% @v_main_sliders = MainEventSlider.where(:event_id => @events_single.id) %>
                <% if !@v_main_sliders.empty? %>
                <ul class="example-orbit" data-orbit>
                  <% @v_main_sliders.each do |main_slider| %>

                  <li>
                    <%= image_tag main_slider.image_url(:slider_main) %>
                    <% if !main_slider.caption.blank? %>
                    <div class="orbit-caption">
                      Caption One.
                    </div>
                    <% end %>
                  </li>
                  <% end %>
                </ul>
                <% end %>

              </div>
            <% end -%>
              <p><%= @events_single.form_params['description'] %></p>
              <p>
                <strong>Date: </strong><%= @events_single.start_date? ? @events_single.start_date.strftime('%A, %B %e, %Y') : '-' %><br />
                <strong>Time: </strong><%= @events_single.form_params['start_time'] %><br />
                <strong>Venue: </strong><%= @events_single.form_params['venue'] %><br />
                <% if @events_single.form_params['type'] == 'main' %>
                  <strong>No. of Participants:</strong> <%= @events_single.attendees_limit %></br>
                        <% if @events_single.document? %>
                        <strong>Document:</strong><%= link_to " Download", @events_single.document_url, class: "" %>
                        <% end -%>

                <% end -%>
              </p>
              <% 
                @v_main_price_and_mileages = MainEventPriceAndMileage.where(:event_id => @events_single.id)
                unless @v_main_price_and_mileages.empty?
              %>
                  <table width="100%">
                    <thead>
                      <tr>
                        <th width="25%">Attendee Category</td>
                        <th width="25%">Price - What do you pay?</td>
                        <th width="50%">Mileage - What do you get?</td>
                      </tr>
                    </thead>
                    <tbody>
              <%
                  @v_main_price_and_mileages.each do |price_and_mileage|
              %>
                      <tr>
                        <td width= "25%"><%= price_and_mileage.attendee_category %></td>
                        <td width="25%"><%= price_and_mileage.price %></td>
                        <td width="50%">
                          <ul class="no-bullet change-color">
                          <li>
                          <%= price_and_mileage.mileage.split("\n").join("</li><li>").html_safe %>
                          </li>
                          </ul>
                        </td>
                      </tr>
              <%
                  end
              %>
                      </tbody>
                    </table>
              <%
                end
              %>
              <div id="_request_for_event_id_<%= @events_single.id %>">
              <%= render partial: "shared/register_for_event", locals: {_y: @events_single.form_params['type'], _z: @events_single.id } %>
              </div>

            <hr />
          <% else %>
          <% @events_all.each do |event| %>
            <li><h5><%= event.form_params['name'] %></h5></li>
            <% if event.form_params['type'] == 'weekly' %>
            <% if !event.attachment.blank? %>
            <p><%= image_tag event.attachment_url, class: 'th-no-hover lazyload' %></p>
            <% end %>
            <% end -%>
            <% if event.form_params['type'] == 'main' %>
              <div class="clearfix">
                <% @v_main_sliders = MainEventSlider.where(:event_id => event.id) %>
                <% if !@v_main_sliders.empty? %>
                <ul class="example-orbit" data-orbit>
                  <% @v_main_sliders.each do |main_slider| %>

                  <li>
                    <%= image_tag main_slider.image_url(:slider) %>
                    <% if !main_slider.caption.blank? %>
                    <div class="orbit-caption">
                      Caption One.
                    </div>
                    <% end %>
                  </li>
                  <% end %>
                </ul>
                <% end %>

              </div>
            <% end -%>
            <p><%= event.form_params['description'] %></p>
            <p>
              <strong>Date: </strong><%= event.start_date? ? event.start_date.strftime('%A, %B %e, %Y') : '-' %><br />
              <strong>Time: </strong><%= event.form_params['start_time'] %><br />
              <strong>Venue: </strong><%= event.form_params['venue'] %><br />
              <% if event.form_params['type'] == 'main' %>
                <strong>No. of Participants:</strong> <%= event.attendees_limit %></br>
                        <% if event.document? %>
                        <strong>Document:</strong><%= link_to " Download", event.document_url, class: "" %>
                        <% end -%>
              <% end -%>
            </p>
            <% 
              @v_main_price_and_mileages = MainEventPriceAndMileage.where(:event_id => event.id)
              unless @v_main_price_and_mileages.empty?
            %>
                <table width="100%">
                  <thead>
                    <tr>
                      <th width="25%">Attendee Category</td>
                      <th width="25%">Price - What do you pay?</td>
                      <th width="50%">Mileage - What do you get?</td>
                    </tr>
                  </thead>
                  <tbody>
            <%
                @v_main_price_and_mileages.each do |price_and_mileage|
            %>
                    <tr>
                      <td width= "25%"><%= price_and_mileage.attendee_category %></td>
                      <td width="25%"><%= price_and_mileage.price %></td>
                      <td width="50%">
                        <ul class="no-bullet change-color">
                        <li>
                        <%= price_and_mileage.mileage.split("\n").join("</li><li>").html_safe %>
                        </li>
                        </ul>
                      </td>
                    </tr>
            <%
                end
            %>
                    </tbody>
                  </table>
            <%
              end
            %>
            <div id="_request_for_event_id_<%= event.id %>">
            <%= render partial: "shared/register_for_event", locals: {_y: event.form_params['type'], _z: event.id } %>
            </div>

            <hr />
          <% end %>
          <% end %>
        </ul>
      <%= render partial: 'layouts/side_footer' %>
</div>
</div>	

